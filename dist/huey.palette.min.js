!function(n){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=n();else if("function"==typeof define&&define.amd)define([],n);else{var e;e="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this,e.palette=n()}}(function(){return function n(e,r,t){function o(f,u){if(!r[f]){if(!e[f]){var a="function"==typeof require&&require;if(!u&&a)return a(f,!0);if(i)return i(f,!0);var c=new Error("Cannot find module '"+f+"'");throw c.code="MODULE_NOT_FOUND",c}var l=r[f]={exports:{}};e[f][0].call(l.exports,function(n){var r=e[f][1][n];return o(r?r:n)},l,l.exports,n,e,r,t)}return r[f].exports}for(var i="function"==typeof require&&require,f=0;f<t.length;f++)o(t[f]);return o}({1:[function(n,e){var r=n("get-image-data"),t=n("./validate"),o=n("./type-check");e.exports=function(n){return function(e,i,f){o(i,"function")&&(f=i,i=null);var u=t(e,f);if(u){if(!f)throw u;return setTimeout(f,0,u)}r(e,function(e,r){if(e)return f(e);var t=n(r.data,i);f(null,t,r)})}}},{"./type-check":5,"./validate":6,"get-image-data":7}],2:[function(n,e){e.exports=function(n,e){for(var r,t,o,i=n.length,f=1e4>i?24:1e5>i?56:1e6>i?512:1e7>i?768:1e8>i?10240:12288,u=0;i>u;u+=f)r=[n[u],n[u+1],n[u+2]],t=Math.min(r[0],Math.min(r[1],r[2])),o=Math.max(r[0],Math.max(r[1],r[2])),24>o-t||e(r)}},{}],3:[function(n,e){e.exports=function(n){function e(n,e){return n.c()-e.c()}function r(n,e){return n.c()*n.v()-e.c()*e.v()}function t(n){var e=[],r=0;return{u:function(n){e.push(n),r=0},o:function(){return r||(e.sort(n),r=1),e.pop()},s:function(){return e.length},m:function(n){return e.map(n)}}}function o(n,e,r,t,o,i,f){var u=this;u.r1=n,u.r2=e,u.g1=r,u.g2=t,u.b1=o,u.b2=i,u.h=f}function i(n,e){for(var r,t,i,f,l,s,p,d,h,g,v,m,b,w,x,y,k,q,C,M,E,N,O,A,D,I,V,P,S,T,U,_=1,j=0;1e3>j;)if(w=n.o(),w.c()){if(x=w.r1,y=w.r2,k=w.g1,q=w.g2,C=w.b1,M=w.b2,t=1+y-x,i=1+q-k,f=1+M-C,l=c.call(0,t,i,f),m=0,g=[],v=[],l==t)for(T=x,U=y,h="r",N=y+1,O=q+1,A=M+1,s=x;N>s;s++){for(b=0,p=k;O>p;p++)for(d=C;A>d;d++)b+=u[1024*s+32*p+d]||0;m+=b,g[s]=m}else if(l==i)for(T=k,U=q,h="g",N=q+1,O=y+1,A=M+1,s=k;N>s;s++){for(b=0,p=x;O>p;p++)for(d=C;A>d;d++)b+=u[32*s+1024*p+d]||0;m+=b,g[s]=m}else for(T=C,U=M,h="b",N=M+1,O=y+1,A=q+1,s=C;N>s;s++){for(b=0,p=x;O>p;p++)for(d=k;A>d;d++)b+=u[1024*p+32*d+s]||0;m+=b,g[s]=m}for(m/=2,E=g.length;E--;)g[E]&&(v[E]=m-g[E]);for(s=T;U>=s;s++)if(g[s]>m){for(D=s-T,I=U-s,S=D>I?c(T,~~(s-1-D/2)):a(U-1,~~(s+I/2));!g[S];)S++;for(r=v[S];!r&&g[S-1];)r=v[--S];V=new o(x,y,k,q,C,M,w.h),V[h+"2"]=S,P=new o(x,y,k,q,C,M,w.h),P[h+"1"]=S+1;break}if(n.u(V),P&&(n.u(P),_++),_>=e||j++>1e3)return}else n.u(w),j++}function f(n,f){u=[];for(var a,c,l,s,p,d=new t(r),h=32,g=0,v=32,m=0,b=32,w=0,x=new t(e),y=new t(r),k=n.length;k;)c=n[--k],l=c[0]>>3,s=c[1]>>3,p=c[2]>>3,h>l?h=l:l>g&&(g=l),v>s?v=s:s>m&&(m=s),b>p?b=p:p>w&&(w=p),a=1024*l+32*s+p,u[a]=(u[a]||0)+1;for(x.u(new o(h,g,v,m,b,w,u)),i(x,.75*f);x.s();)y.u(x.o());for(i(y,f-y.s());y.s();)d.u(y.o());return d.m(function(n){return n.a()})}var u,a=n.min,c=n.max;return o.prototype={v:function(){var n=this;return n.V||(n.V=(n.r2-n.r1+1)*(n.g2-n.g1+1)*(n.b2-n.b1+1)),n.V},c:function(){var n=this;if(!n.S){for(var e,r,t,o,i=n.h,f=0,u=n.r1-1,a=n.r2+1;++u<a;)for(e=n.g1-1,r=n.g2+1;++e<r;)for(t=n.b1-1,o=n.b2+1;++t<o;)f+=i[1024*u+32*e+t]||0;n.C=f,n.S=1}return n.C},a:function(){var n=this,e=n.h;if(!n.A){for(var r,t,o,i,f,u=0,a=0,c=0,l=0,s=n.r1-1,p=n.r2+1;++s<p;)for(t=n.g1-1,o=n.g2+1;++t<o;)for(i=n.b1-1,f=n.b2+1;++i<f;)r=e[1024*s+32*t+i],r&&(u+=r,a+=r*(.5+s),c+=r*(.5+t),l+=r*(.5+i));n.A=u?[~~(8*a/u),~~(8*c/u),~~(8*l/u)]:[~~(4*(1+n.r1+n.r2)),~~(4*(1+n.g1+n.g2)),~~(4*(1+n.b1+n.b2))]}return n.A}},f}(Math)},{}],4:[function(n,e){var r=n("./backwards-compatibility");e.exports=r(n("../palette"))},{"../palette":10,"./backwards-compatibility":1}],5:[function(n,e){e.exports=function(n,e){return n&&typeof n===e}},{}],6:[function(n,e){var r=n("./type-check");e.exports=function(n,e){var t=r(n,"undefined")?"Please provide an image path.":r(e,"function")?null:"Please provide a callback function.";return t?new Error(t):!1}},{"./type-check":5}],7:[function(n,e){var r=n("get-image"),t=n("./shared"),o=null,i=function(n){return o=n.createElement("canvas"),!(!o.getContext||!o.getContext("2d"))}(document);e.exports=function(n,e){return i?void r(n,function(n,r){n?e(n):e(null,t(o)(r))}):e(new Error("Your browser doesnâ€™t the <canvas> element"))}},{"./shared":9,"get-image":8}],8:[function(n,e){e.exports=function(n,e){var r=new Image;/^data/.test(n)||(r.crossOrigin=!0),r.src=n,r.onerror=e,r.onload=function(){e(null,r)}}},{}],9:[function(n,e){e.exports=function(n){return function(e){var r=n.getContext("2d");return n.width=e.width,n.height=e.height,r.drawImage(e,0,0),r.getImageData(0,0,e.width,e.height)}}},{}],10:[function(n,e){var r=n("./lib/each"),t=n("./lib/mmcq");e.exports=function(n,e){e=isNaN(e)?5:e;var o=[];return r(n,function(n){o.push(n)}),t(o,255!==e?e+1:e).slice(0,e)}},{"./lib/each":2,"./lib/mmcq":3}]},{},[4])(4)});